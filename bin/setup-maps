#!/bin/bash

umask 077

INSTALL="/usr/local/games/minecraft"

if [ ! -d $INSTALL/overviewer ]; then
    cd $INSTALL

    if ! git clone https://github.com/overviewer/Minecraft-Overviewer.git overviewer &>>/tmp/minecraft-maps-setup ; then
        exit -1
    fi

    cd overviewer

    if ! python setup.py build &>>minecraft-maps-setup ; then
        exit -1
    fi

    chown -R mcraft:mcraft $INSTALL/overviewer
fi

if [ ! -d $INSTALL/maps ]; then
    mkdir -p $INSTALL/maps $INSTALL/maps/build $INSTALL/maps/www
    chown -R mcraft:mcraft $INSTALL/maps
fi

chmod 711 $INSTALL $INSTALL/maps $INSTALL/maps/www

