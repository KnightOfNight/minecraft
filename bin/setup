#!/bin/bash


umask 077

export INSTALL="/usr/local/games/minecraft"


# user and group
groupadd -g 900 mcraft
useradd -g mcraft mcraft
passwd -l mcraft

if ! grep -q umask /home/mcraft/.bashrc; then
    cat >> /home/mcraft/.bashrc << END
umask 077
export PATH="/usr/local/games/minecraft/bin:$PATH"
alias home="cd /usr/local/games/minecraft"
END
fi


# dirs
mkdir -p $INSTALL

for subdir in backups bin etc jars logs servers snapshots; do
    mkdir -p $INSTALL/$subdir
done

chown -R mcraft:mcraft $INSTALL
find $INSTALL -type d | xargs chmod -v 700


# scripts
for script in bin/mcctl bin/make-maps bin/make-maps-configs; do
    if [ ! -s "$script" ]; then
        echo "ERROR: $script not found"
        exit -1
    fi
    cp $script $INSTALL/bin/
done

chmod -vr 700 $INSTALL/bin/*

